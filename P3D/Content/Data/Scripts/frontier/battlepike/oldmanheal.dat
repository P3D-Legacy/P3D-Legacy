version=2
@storage.set(integer,potheals,0)

:if:<pokemon.fullyhealed(0)>=false
	@storage.set(integer,potheals,<storage.get(integer,potheals)>+1)
:endif
:if:<pokemon.fullyhealed(1)>=false
	@storage.set(integer,potheals,<storage.get(integer,potheals)>+1)
:endif
:if:<pokemon.fullyhealed(2)>=false
	@storage.set(integer,potheals,<storage.get(integer,potheals)>+1)
:endif

:select:<storage.get(integer,potheals)>
	:when:0
		@text.show(You are already fully healed!)
	:when:1
		@text.show(Ah, you're a lucky one.~I'm in somewhat-good~spirits now.*I will restore one of your~Pokémon to full health.)
		@pokemon.heal
	:when:2
		:select:<system.random(1,2)>
			:when:1
				@text.show(Ah, you're a lucky one.~I'm in somewhat-good~spirits now.*I will restore one of your~Pokémon to full health.)
				:select:<system.random(0,2)>
					:when:0
						:if:<pokemon.fullyhealed(0)>=false
							@pokemon.heal(0)
						:else
							@pokemon.heal(<system.random(1,2)>)						
						:endif
					:when:1
						:if:<pokemon.fullyhealed(1)>=false
							@pokemon.heal(1)
						:else
							:select:<system.random(0,1)>
								:when:0
									@pokemon.heal(0)
								:when:1
									@pokemon.heal(2)
							:endwhen
						:endif
					:when:2
						:if:<pokemon.fullyhealed(2)>=false
							@pokemon.heal(2)
						:else
							@pokemon.heal(<system.random(0,1)>)						
						:endif
				:endwhen
			:when:2
				@text.show(Ah, you're a lucky one.~I'm in somewhat-good~spirits now.*I will restore two of your~Pokémon to full health.)
				@pokemon.heal
		:endwhen
	:when:3
		:select:<system.random(1,2)>
			:when:1
				@text.show(Ah, you're a lucky one.~I'm in somewhat-good~spirits now.*I will restore one of your~Pokémon to full health.)
				@pokemon.heal(<system.random(0,2)>)
			:when:2
				@text.show(Ah, you're a lucky one.~I'm in somewhat-good~spirits now.*I will restore two of your~Pokémon to full health.)
				:select:<system.random(0,2)>
					:when:0
						@pokemon.heal(1,2)
					:when:1
						@pokemon.heal(0,2)
					:when:2
						@pokemon.heal(0,1)
				:endwhen
		:endwhen
:endwhen
@text.show(The best of luck to you.~Farewell.)
@npc.turn(11,0)
@npc.move(11,2)
:end